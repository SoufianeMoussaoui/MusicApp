@model EditProfileViewModel
@{
    ViewBag.Title = "Edit Profile";
    ViewBag.IsAuthenticated = true;
}

<style>
    .form-card {
        background: rgba(30, 41, 59, 0.5);
        border: 1px solid rgba(168, 85, 247, 0.1);
        backdrop-filter: blur(10px);
    }

    .form-label {
        color: #cbd5e1;
        font-weight: 500;
        margin-bottom: 8px;
        display: block;
    }

    .form-input {
        background-color: rgba(15, 23, 42, 0.8);
        border: 1px solid rgba(71, 85, 105, 0.6);
        color: white;
        transition: all 0.3s ease;
        width: 100%;
        padding: 12px 16px;
        border-radius: 8px;
    }

    .form-input:focus {
        background-color: rgba(15, 23, 42, 1);
        border-color: #a78bfa;
        box-shadow: 0 0 0 3px rgba(168, 85, 247, 0.1);
        outline: none;
    }

    .genre-select {
        background-color: rgba(15, 23, 42, 0.8);
        border: 1px solid rgba(71, 85, 105, 0.6);
        color: white;
        width: 100%;
        padding: 12px 16px;
        border-radius: 8px;
        cursor: pointer;
    }

    .genre-select:focus {
        border-color: #a78bfa;
        box-shadow: 0 0 0 3px rgba(168, 85, 247, 0.1);
        outline: none;
    }

    .genre-select option {
        background-color: #1e293b;
        color: white;
    }
</style>

<div class="gradient-bg min-h-screen">
    <div class="max-w-4xl mx-auto px-4 py-8">
        <!-- Back Button -->
        <div class="mb-6">
            <a href="@Url.Action("Profile", "User")" 
               class="inline-flex items-center text-purple-400 hover:text-purple-300">
                <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 19l-7-7m0 0l7-7m-7 7h18"></path>
                </svg>
                Back to Profile
            </a>
        </div>

        <!-- Form Card -->
        <div class="form-card p-8 rounded-2xl">
            <h1 class="text-3xl font-bold text-white mb-2">Edit Profile</h1>
            <p class="text-slate-400 mb-8">Update your personal information</p>

            <form method="post" asp-action="EditProfile">
                @Html.AntiForgeryToken()
                <input type="hidden" asp-for="UserId" />

                <!-- Success/Error Messages -->
                @if (TempData["SuccessMessage"] != null)
                {
                    <div class="mb-6 p-4 bg-green-900/30 border border-green-700 text-green-200 rounded-lg">
                        @TempData["SuccessMessage"]
                    </div>
                }
                @if (TempData["ErrorMessage"] != null)
                {
                    <div class="mb-6 p-4 bg-red-900/30 border border-red-700 text-red-200 rounded-lg">
                        @TempData["ErrorMessage"]
                    </div>
                }

                <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-8">
                    <div>
                        <label asp-for="Username" class="form-label">Username *</label>
                        <input asp-for="Username" class="form-input" required />
                        <span asp-validation-for="Username" class="text-red-400 text-sm"></span>
                    </div>
                    <div>
                        <label asp-for="Email" class="form-label">Email *</label>
                        <input asp-for="Email" type="email" class="form-input" required />
                        <span asp-validation-for="Email" class="text-red-400 text-sm"></span>
                    </div>

                    <div>
                        <label asp-for="Firstname" class="form-label">First Name</label>
                        <input asp-for="Firstname" class="form-input" />
                    </div>
                    <div>
                        <label asp-for="Lastname" class="form-label">Last Name</label>
                        <input asp-for="Lastname" class="form-input" />
                    </div>

                    <!-- Genre -->
                    <div>
                        <label asp-for="Genre" class="form-label">Favorite Genre</label>
                        <select asp-for="Genre" class="genre-select">
                            <option value="">Select a genre</option>
                            <option value="Rock">Rock</option>
                            <option value="Pop">Pop</option>
                            <option value="Hip Hop">Hip Hop</option>
                            <option value="Jazz">Jazz</option>
                            <option value="Electronic">Electronic</option>
                            <option value="Classical">Classical</option>
                            <option value="Country">Country</option>
                            <option value="R&B">R&B</option>
                            <option value="Metal">Metal</option>
                            <option value="Other">Other</option>
                        </select>
                    </div>
                </div>

                <div class="flex justify-end space-x-4 pt-6 border-t border-slate-800">
                    <a href="@Url.Action("Profile", "User")" 
                       class="px-6 py-3 border border-slate-700 text-slate-300 rounded-lg hover:bg-slate-800 transition-colors">
                        Cancel
                    </a>
                    <button type="submit" 
                            class="px-6 py-3 bg-gradient-to-r from-purple-600 to-pink-600 text-white rounded-lg hover:opacity-90 transition-opacity">
                        Save Changes
                    </button>
                </div>
            </form>
        </div>
    </div>
</div>

@section Scripts {
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Set the selected genre
            const genreSelect = document.querySelector('select[name="Genre"]');
            const currentGenre = "@Model.Genre";
            
            if (genreSelect && currentGenre) {
                for (let i = 0; i < genreSelect.options.length; i++) {
                    if (genreSelect.options[i].value === currentGenre) {
                        genreSelect.selectedIndex = i;
                        break;
                    }
                }
            }
            
            // Form validation
            const form = document.querySelector('form');
            form.addEventListener('submit', function(event) {
                const username = document.querySelector('input[name="Username"]');
                const email = document.querySelector('input[name="Email"]');
                
                if (!username.value.trim() || !email.value.trim()) {
                    event.preventDefault();
                    alert('Username and Email are required.');
                }
            });
        });
    </script>
}